-- üß¨ Pet Ager & Fake KG Tool (Final Proportional Lean Scaling)
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local TweenService = game:GetService("TweenService")

repeat task.wait() until player:FindFirstChild("PlayerGui")

-- === CONFIG ===
local AGE_SPEED = 0.05
local AGE_STEPS = 50

-- Multipliers (lean proportions)
local BODY_MULT = Vector3.new(1.5, 3.5, 1.5)  -- mas mataas kaysa malapad
local WING_MULT = Vector3.new(3.0, 1.5, 3.0)  -- malapad at mahaba pero di makapal
local TAIL_MULT = Vector3.new(2.0, 2.0, 2.0)  -- proportionate tail size

-- === GUI ===
local gui = Instance.new("ScreenGui")
gui.Name = "PetModifierGUI"
gui.ResetOnSpawn = false
gui.Parent = player.PlayerGui

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 270, 0, 200)
frame.Position = UDim2.new(1, -280, 0.4, 0)
frame.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
frame.Active = true
frame.Draggable = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 26)
title.Text = "üêæ Pet Visual Modifier"
title.BackgroundTransparency = 1
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.GothamSemibold
title.TextSize = 18

local function createBtn(text, yPos, color)
	local btn = Instance.new("TextButton", frame)
	btn.Size = UDim2.new(0.85, 0, 0, 36)
	btn.Position = UDim2.new(0.075, 0, yPos, 0)
	btn.BackgroundColor3 = color
	btn.Text = text
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 15
	btn.TextColor3 = Color3.new(1, 1, 1)
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
	return btn
end

local ageBtn = createBtn("üïí Age to 50 (Huge Lean)", 0.2, Color3.fromRGB(255, 140, 140))
local kgBtn  = createBtn("‚öñÔ∏è KG to 50 (Huge Lean)", 0.35, Color3.fromRGB(140, 255, 140))
local resetBtn = createBtn("üîÅ Reset Held Pet", 0.5, Color3.fromRGB(100, 180, 255))

local progressBar = Instance.new("Frame", frame)
progressBar.Size = UDim2.new(0.85, 0, 0, 20)
progressBar.Position = UDim2.new(0.075, 0, 0.76, 0)
progressBar.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
Instance.new("UICorner", progressBar).CornerRadius = UDim.new(0, 6)

local fill = Instance.new("Frame", progressBar)
fill.BackgroundColor3 = Color3.fromRGB(0, 255, 140)
fill.Size = UDim2.new(0, 0, 1, 0)
Instance.new("UICorner", fill).CornerRadius = UDim.new(0, 6)

local credit = Instance.new("TextLabel", frame)
credit.Size = UDim2.new(1, 0, 0, 18)
credit.Position = UDim2.new(0, 0, 1, -18)
credit.Text = "Made by KielCrafts + Lean Scaling"
credit.TextColor3 = Color3.fromRGB(160, 160, 160)
credit.Font = Enum.Font.Gotham
credit.TextSize = 12
credit.BackgroundTransparency = 1

-- === DATA ===
local originalData = {}

local function storeOriginal(tool)
	if not originalData[tool] then
		originalData[tool] = { name = tool.Name, sizes = {} }
		for _, obj in pairs(tool:GetDescendants()) do
			if obj:IsA("BasePart") then
				originalData[tool].sizes[obj] = obj.Size
			elseif obj:IsA("SpecialMesh") then
				originalData[tool].sizes[obj] = obj.Scale
			end
		end
	end
end

local function resetPet(tool)
	if originalData[tool] then
		tool.Name = originalData[tool].name
		for obj, size in pairs(originalData[tool].sizes) do
			if obj:IsA("BasePart") then
				obj.Size = size
			elseif obj:IsA("SpecialMesh") then
				obj.Scale = size
			end
		end
	end
end

local function getMultiplier(partName)
	local nameLower = partName:lower()
	if nameLower:find("wing") then
		return WING_MULT
	elseif nameLower:find("tail") then
		return TAIL_MULT
	else
		return BODY_MULT
	end
end

local function scalePetLean(tool, progress)
	for obj, originalSize in pairs(originalData[tool].sizes) do
		local factor = getMultiplier(obj.Name)
		local targetSize = Vector3.new(
			originalSize.X * factor.X,
			originalSize.Y * factor.Y,
			originalSize.Z * factor.Z
		)
		local newSize = originalSize:Lerp(targetSize, progress)

		if obj:IsA("BasePart") then
			obj.Size = newSize
		elseif obj:IsA("SpecialMesh") then
			obj.Scale = newSize
		end
	end
end

local function updateName(baseName, mode, step)
	local newLabel = (mode == "age") and ("[Age " .. step .. "]") or ("[" .. step .. " KG]")
	-- Palitan lang kung may existing bracket
	if baseName:find("%[.-%]") then
		return baseName:gsub("%[.-%]", newLabel)
	else
		return baseName .. " " .. newLabel
	end
end

local function visualGrow(tool, mode)
	storeOriginal(tool)
	local baseName = originalData[tool].name
	fill.Size = UDim2.new(0, 0, 1, 0)
	fill.BackgroundColor3 = (mode == "age") and Color3.fromRGB(255, 140, 140) or Color3.fromRGB(140, 255, 140)
	TweenService:Create(fill, TweenInfo.new(AGE_SPEED * AGE_STEPS, Enum.EasingStyle.Linear), {
		Size = UDim2.new(1, 0, 1, 0)
	}):Play()

	for i = 1, AGE_STEPS do
		tool.Name = updateName(baseName, mode, i)
		scalePetLean(tool, i / AGE_STEPS)
		task.wait(AGE_SPEED)
	end
end

-- === EVENTS ===
ageBtn.MouseButton1Click:Connect(function()
	local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
	if tool then
		visualGrow(tool, "age")
	else
		warn("No pet equipped.")
	end
end)

kgBtn.MouseButton1Click:Connect(function()
	local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
	if tool then
		visualGrow(tool, "kg")
	else
		warn("No pet equipped.")
	end
end)

resetBtn.MouseButton1Click:Connect(function()
	local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
	if tool then
		resetPet(tool)
	else
		warn("No pet equipped.")
	end
end)
